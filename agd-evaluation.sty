\ProvidesPackage{agd-evaluation}
% Copyright (C) 2013 Andrew Gainer-Dewar <andrew.gainer.dewar@gmail.com>
% This file may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either
% version 1.2 of this license or (at your option) any later
% version. The latest version of this license is in:
% http://www.latex-project.org/lppl.txt
% and version 1.2 or later is part of all distributions of
% LaTeX version 1999/12/01 or later.

\usepackage[american]{babel}
\usepackage[babel]{csquotes}

\usepackage{hyperref}

\usepackage[margin=1in,letterpaper]{geometry}

\usepackage[T1]{fontenc}
\usepackage{kpfonts}

\usepackage{microtype}

\usepackage{enumitem}
\usepackage{tabularx}
\usepackage{pbox}

\newcommand{\thecourse}[1]{\csname course@#1\endcsname}

\newcommand{\coursenum}[1]{\gdef\course@num{#1}} %Course number
\newcommand{\coursename}[1]{\gdef\course@name{#1}} %Course name
\newcommand{\courseterm}[1]{\gdef\course@term{#1}} %Course term
\newcommand{\courseplace}[1]{\gdef\course@place{#1}} %Course institution
\newcommand{\courseinst}[1]{\gdef\course@inst{#1}} %Course instructor

\newcommand{\instructions}[1]{\gdef\theinstructions{#1}} %Instructions for the evaluation

\renewcommand{\@maketitle}{%
  \vspace{\droptitle}
  \begin{flushleft}
    \textsc{\normalsize \thecourse{inst}, \thecourse{place}} \\[\baselineskip]
    \textbf{\Huge \thecourse{num}: \thecourse{name}} \\[\baselineskip]
    \textbf{\Huge Course Questionaire (\thecourse{term})} \\[\baselineskip]
    {\normalsize \theinstructions}
  \end{flushleft}
}

\newenvironment{saquestions}{\begin{enumerate}[labelindent=\parindent, leftmargin=*, label={Q\arabic*:}, noitemsep]}{\end{enumerate}}

\newcommand{\saquestion}[2][2in]{\item {#2} \vspace{#1}}

\newcommand{\rankinst}[1]{\pbox{1cm}{\centering \tiny #1}}

\newenvironment{rankquestions}{
  For each of the following, please circle the response that best reflects your feelings about the course.
  
  \tabularx{\columnwidth}{X c c c c c}
  & \rankinst{Strongly disagree} & \rankinst{Weakly disagree} & \rankinst{Neutral} & \rankinst{Weakly agree} & \rankinst{Strongly agree} \\
  }
  {
    \endtabularx
  }

\newcounter{rank}
\setcounter{rank}{1}
\newcommand{\rankquestion}[1]{R\arabic{rank}\addtocounter{rank}{1}: {#1} & 1 & 2 & 3 & 4 & 5 \\}

\pagestyle{empty}
\aliaspagestyle{title}{empty}
